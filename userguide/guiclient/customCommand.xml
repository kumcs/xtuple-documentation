<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright (c) 1998-2008 by xTuple. All rights reserved. -->
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
"http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<section id="customCommand">
  <title><indexterm significance="normal">
      <primary>custom commands</primary>
      <secondary>creating new</secondary>
    </indexterm>Custom Command</title>
  <para>To create a new Custom Command, select the NEW button. The following
  screen will appear:</para>
  <para><screenshot>
      <mediaobject>
        <imageobject>
          <imagedata fileref="images/Sys_custCommNew.png" />
        </imageobject>
        <caption>Enter New Custom Command</caption>
      </mediaobject>
    </screenshot></para>
  <para>When creating a new Custom Command, you are presented with the
  following options:</para>
  <variablelist>
    <varlistentry>
      <term>Module</term>
      <listitem>
        <para>Select the name of the module where you want the custom menu
        option to appear. You may create Custom Commands for any of the
        modules within the system. By default, a menu option named "Custom"
        will be added to the bottom of a module's menu structure when a Custom
        Command is created for that module.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>Menu Label</term>
      <listitem>
        <para>Enter a name to identify the Custom Command as it will appear on
        the menu structure. The menu label will become a subset of the
        "Custom" menu option appearing at the bottom of a module's menu
        structure. Each menu label should be used to describe a separate
        Custom Command. There is no limit to the number of Custom Commands
        which may be added to a module.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>Priv. Name</term>
      <listitem>
        <para>Enter a name to describe the privilege associated with the
        Custom Command. By associating a privilege with a Custom Command, you
        gain the ability to grant or withhold access to the menu option on a
        user-by-user basis. Users who have have been granted the privilege
        will have access to the Custom Command; all others will not.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>Executable</term>
      <listitem>
        <para>Enter the path to the location where the executable program you
        want to launch is located. The executable program specified here will
        be launched when users select the associated Custom Command menu
        option. For example, if you want to run a custom report, specify the
        location for the standalone report renderer ("RPTrender"). The
        following examples illustrate how (on Windows) you can map to either
        local or network drives:</para>
        <example>
          <title>Custom Windows Paths</title>
          <para>Local Drive: C:\\Program Files\\OpenMFG\\RPTrender.exe</para>
          <para>Network URL:
          \\\\drive_name\\dir_name\\OpenMFG\\RPTrender.exe</para>
        </example>
      </listitem>
    </varlistentry>
  </variablelist>
  <note>
    <para>You may encounter cross-platform conflicts when placing executables
    on network drives. To reduce these conflicts, it may be necessary to
    create separate custom menus to support executables designed for different
    operating systems.</para>
  </note>
  <tip>
    <para>Macintosh users should enter an executable path which points all the
    way to the executable file located within a package's Contents directory.
    For example, to launch the report renderer, enter the following path:
    ../rptrender.app/Contents/MacOS/rptrender. Under Mac, the RPTrender
    application will not open if the path does not continue past the
    rptrender.app file.</para>
  </tip>
  <variablelist>
    <varlistentry>
      <term>Description</term>
      <listitem>
        <para>Enter text to describe the Custom Command.</para>
      </listitem>
    </varlistentry>
  </variablelist>
  <para>If you want the system to pass parameters or other arguments to the
  specified executable program when it is launched, select the "Arguments"
  tab. The following screen will appear:</para>
  <para><screenshot>
      <mediaobject>
        <imageobject>
          <imagedata fileref="images/Sys_custCommArg.png" />
        </imageobject>
        <caption>Custom Command Arguments</caption>
      </mediaobject>
    </screenshot></para>
  <note>
    <para>While the examples shown here emphasize arguments passed to the
    report renderer, you may pass arguments to any other program executed from
    a Custom Command menu.</para>
  </note>
  <para>The arguments display lists all arguments defined for the specified
  executable program. The arguments shown in the example illustrate typical
  arguments needed to run custom reports from the system. As the example
  shows, the following arguments will be passed to the RPTrender application
  when the Custom Command is executed:</para>
  <table>
    <title>Arguments Used for Custom Reports</title>
    <tgroup cols="2">
      <thead>
        <row>
          <entry><para>Syntax</para></entry>
          <entry><para>Description</para></entry>
        </row>
      </thead>
      <tbody>
        <row>
          <entry><para>-databaseURL</para></entry>
          <entry><para>Used to specify the location of the database server. In
          the example shown, the prefix "psql://" indicates a connection to a
          PostgreSQL data base. This is followed by the server address,
          database name, and port number. When the report renderer (RPTrender)
          is launched, the program will automatically connect to the database
          specified.</para></entry>
        </row>
        <row>
          <entry><para>-username</para></entry>
          <entry><para>Enter the username RPTrender should use to connect to
          the specified database.</para></entry>
        </row>
        <row>
          <entry><para>-passwd</para></entry>
          <entry><para>Enter the password for the specified
          user.</para></entry>
        </row>
        <row>
          <entry><para>-param</para></entry>
          <entry><para>Enter any parameters you want the system to pass to the
          report renderer. These pre-defined parameters will be used when
          RPTrender runs the specified report definition.</para></entry>
        </row>
        <row>
          <entry><para>-print</para></entry>
          <entry><para>This argument tells RPTrender to print the specified
          report definition using the indicated parameters -- if
          any.</para></entry>
        </row>
        <row>
          <entry><para>-close</para></entry>
          <entry><para>Use this argument to close the RPTrender program when
          its work is done.</para></entry>
        </row>
      </tbody>
    </tgroup>
  </table>
  <para>To the far right of the screen, the following buttons are
  available:</para>
  <variablelist>
    <varlistentry>
      <term>CLOSE</term>
      <listitem>
        <para>Closes the screen, returning you to the application
        desktop.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>NEW</term>
      <listitem>
        <para>Opens screen for creating a new argument.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>EDIT</term>
      <listitem>
        <para>Enables you to edit highlighted argument definitions. The edit
        screen is the same as that for creating a new argument
        definition--except that when editing, the fields will contain argument
        information. Double-clicking on an argument definition will also bring
        you to the editing screen.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>DELETE</term>
      <listitem>
        <para>Highlight an argument definition and then select this button to
        remove the argument from the list.</para>
      </listitem>
    </varlistentry>
  </variablelist>
  <xi:include href="customCommandArgument.xml"
              xmlns:xi="http://www.w3.org/2001/XInclude"
              xpointer="element(/1)" />
</section>
